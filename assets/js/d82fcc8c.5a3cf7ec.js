"use strict";(globalThis.webpackChunkmy_web=globalThis.webpackChunkmy_web||[]).push([[5786],{2155:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>h,contentTitle:()=>c,default:()=>x,frontMatter:()=>i,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"fragment/sql\u811a\u672c","title":"sql\u811a\u672c","description":"\u4e0b\u9762\u6211\u5c06\u4ee5\u201c\u4f60\u662f\u4e00\u4e2a\u53ea\u719f\u6089 MySQL \u57fa\u672c DML \u7684\u5f00\u53d1\u4eba\u5458\uff0c\u8981\u8d1f\u8d23 Oracle \u76f8\u5173\u5de5\u4f5c\u201d\u4e3a\u524d\u63d0\uff0c\u7cfb\u7edf\u6027\u8bb2\u89e3 Oracle PL/SQL \u7684\u5e38\u7528\u8bed\u6cd5\uff08\u53d8\u91cf\u3001\u5217\u8868\u3001\u5faa\u73af\u3001\u5224\u65ad\u3001\u5f02\u5e38\u3001\u65e5\u5fd7\u7b49\uff09\uff0c\u5e76\u7ed9\u51fa\u4e00\u5957\u53ef\u76f4\u63a5\u7528\u4e8e\u751f\u4ea7\u3001\u5177\u6709\u9ad8\u5065\u58ee\u6027\u7684\u793a\u4f8b\u811a\u672c\u6a21\u677f\u3002","source":"@site/docs/fragment/sql\u811a\u672c.md","sourceDirName":"fragment","slug":"/fragment/sql\u811a\u672c","permalink":"/docs/fragment/sql\u811a\u672c","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/fragment/sql\u811a\u672c.md","tags":[],"version":"current","frontMatter":{},"sidebar":"fragmentSidebar","previous":{"title":"NPM \u8bbe\u7f6e\u4ee3\u7406","permalink":"/docs/fragment/nmp"},"next":{"title":"vim\u4f7f\u7528\u6307\u5357","permalink":"/docs/fragment/vim"}}');var r=s(4848),d=s(8453);const i={},c=void 0,h={},t=[{value:"2.1 \u57fa\u672c\u7c7b\u578b",id:"21-\u57fa\u672c\u7c7b\u578b",level:3},{value:"2.2 \u4f7f\u7528\u8868\u5b57\u6bb5\u7684\u7c7b\u578b\uff08\u63a8\u8350\uff09",id:"22-\u4f7f\u7528\u8868\u5b57\u6bb5\u7684\u7c7b\u578b\u63a8\u8350",level:3},{value:"4.1 \u76f4\u63a5\u8d4b\u503c",id:"41-\u76f4\u63a5\u8d4b\u503c",level:3},{value:"4.2 SQL \u67e5\u8be2\u8d4b\u503c\uff08SELECT INTO\uff09",id:"42-sql-\u67e5\u8be2\u8d4b\u503cselect-into",level:3},{value:"5.1 IF \u8bed\u53e5",id:"51-if-\u8bed\u53e5",level:3},{value:"5.2 CASE",id:"52-case",level:3},{value:"6.1 FOR \u5faa\u73af",id:"61-for-\u5faa\u73af",level:3},{value:"6.2 WHILE \u5faa\u73af",id:"62-while-\u5faa\u73af",level:3},{value:"6.3 LOOP + EXIT",id:"63-loop--exit",level:3},{value:"\u2714 1. \u5fc5\u987b\u8bb0\u5f55\u65e5\u5fd7\uff08\u4f7f\u7528\u81ea\u6cbb\u4e8b\u52a1\uff09",id:"-1-\u5fc5\u987b\u8bb0\u5f55\u65e5\u5fd7\u4f7f\u7528\u81ea\u6cbb\u4e8b\u52a1",level:3},{value:"\u2714 2. \u5fc5\u987b\u6709\u5f02\u5e38\u6355\u83b7",id:"-2-\u5fc5\u987b\u6709\u5f02\u5e38\u6355\u83b7",level:3},{value:"\u2714 3. \u5173\u952e\u6b65\u9aa4\u524d\u5fc5\u987b\u5199\u65e5\u5fd7\uff08\u65b9\u4fbf\u6062\u590d\uff09",id:"-3-\u5173\u952e\u6b65\u9aa4\u524d\u5fc5\u987b\u5199\u65e5\u5fd7\u65b9\u4fbf\u6062\u590d",level:3},{value:"\u2714 4. \u6c38\u8fdc\u4e0d\u8981\u4f7f\u7528\u9690\u5f0f\u63d0\u4ea4\uff08\u5982 DDL\uff09",id:"-4-\u6c38\u8fdc\u4e0d\u8981\u4f7f\u7528\u9690\u5f0f\u63d0\u4ea4\u5982-ddl",level:3},{value:"\u2714 5. \u68c0\u67e5\u5f71\u54cd\u884c\u6570\uff0c\u907f\u514d\u8bef\u4f24\uff08SQL%ROWCOUNT\uff09",id:"-5-\u68c0\u67e5\u5f71\u54cd\u884c\u6570\u907f\u514d\u8bef\u4f24sqlrowcount",level:3},{value:"\u2714 6. \u4f7f\u7528 %TYPE,%ROWTYPE \u6765\u517c\u5bb9\u5b57\u6bb5\u53d8\u66f4",id:"-6-\u4f7f\u7528-typerowtype-\u6765\u517c\u5bb9\u5b57\u6bb5\u53d8\u66f4",level:3},{value:"\u2714 7. \u8981\u6709\u201c\u5e72\u8dd1\u201d\u6a21\u5f0f\uff08DRY RUN\uff09\uff0c\u53ea\u7edf\u8ba1\u4e0d\u66f4\u65b0",id:"-7-\u8981\u6709\u5e72\u8dd1\u6a21\u5f0fdry-run\u53ea\u7edf\u8ba1\u4e0d\u66f4\u65b0",level:3},{value:"\u2714 8. \u907f\u514d\u4e00\u6b21\u66f4\u65b0\u767e\u4e07\u884c\uff0c\u4f7f\u7528\u5206\u6279\u5904\u7406\uff08LIMIT 1000\uff09",id:"-8-\u907f\u514d\u4e00\u6b21\u66f4\u65b0\u767e\u4e07\u884c\u4f7f\u7528\u5206\u6279\u5904\u7406limit-1000",level:3}];function a(n){const e={code:"code",h1:"h1",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(e.p,{children:["\u4e0b\u9762\u6211\u5c06\u4ee5\u201c\u4f60\u662f\u4e00\u4e2a\u53ea\u719f\u6089 MySQL \u57fa\u672c DML \u7684\u5f00\u53d1\u4eba\u5458\uff0c\u8981\u8d1f\u8d23 Oracle \u76f8\u5173\u5de5\u4f5c\u201d\u4e3a\u524d\u63d0\uff0c\u7cfb\u7edf\u6027\u8bb2\u89e3 Oracle PL/SQL \u7684\u5e38\u7528\u8bed\u6cd5\uff08\u53d8\u91cf\u3001\u5217\u8868\u3001\u5faa\u73af\u3001\u5224\u65ad\u3001\u5f02\u5e38\u3001\u65e5\u5fd7\u7b49\uff09\uff0c\u5e76\u7ed9\u51fa\u4e00\u5957",(0,r.jsx)(e.strong,{children:"\u53ef\u76f4\u63a5\u7528\u4e8e\u751f\u4ea7\u3001\u5177\u6709\u9ad8\u5065\u58ee\u6027"}),"\u7684\u793a\u4f8b\u811a\u672c\u6a21\u677f\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u5185\u5bb9\u5206\u6210\u4e24\u90e8\u5206\uff1a"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"\u4e00plsql-\u6700\u5e38\u7528\u8bed\u6cd5\u8bb2\u89e3\u4e0a\u624b\u5373\u53ef\u7528",children:(0,r.jsx)(e.strong,{children:"\u4e00\u3001PL/SQL \u6700\u5e38\u7528\u8bed\u6cd5\u8bb2\u89e3\uff08\u4e0a\u624b\u5373\u53ef\u7528\uff09"})}),"\n",(0,r.jsxs)(e.p,{children:["Oracle \u7684 PL/SQL \u662f\u4e00\u79cd",(0,r.jsx)(e.strong,{children:"\u8fc7\u7a0b\u5316 SQL \u8bed\u8a00"}),"\uff0c\u8bed\u6cd5\u7c7b\u4f3c\u4e8e\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"SQL\uff08DML/DQL\uff09"}),"\n",(0,r.jsx)(e.li,{children:"Java\uff08\u53d8\u91cf\u3001\u5faa\u73af\u3001\u5f02\u5e38\u7b49\u7ed3\u6784\uff09"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"1-plsql-\u4ee3\u7801\u7684\u57fa\u672c\u7ed3\u6784",children:(0,r.jsx)(e.strong,{children:"1. PL/SQL \u4ee3\u7801\u7684\u57fa\u672c\u7ed3\u6784"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"DECLARE\n    -- \u53d8\u91cf\u58f0\u660e\u533a\nBEGIN\n    -- \u6267\u884c\u533a\nEXCEPTION\n    -- \u5f02\u5e38\u6355\u83b7\u533a\nEND;\n/\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u6ce8\u610f\uff1a\u6700\u540e\u8981\u52a0 ",(0,r.jsx)(e.code,{children:"/"})," \u6765\u6267\u884c\u6574\u4e2a\u5757\u3002"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"2-\u53d8\u91cf\u58f0\u660edeclare",children:(0,r.jsx)(e.strong,{children:"2. \u53d8\u91cf\u58f0\u660e\uff08DECLARE\uff09"})}),"\n",(0,r.jsx)(e.h3,{id:"21-\u57fa\u672c\u7c7b\u578b",children:"2.1 \u57fa\u672c\u7c7b\u578b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"DECLARE\n    v_name VARCHAR2(50);\n    v_age  NUMBER := 18;      -- \u76f4\u63a5\u8d4b\u521d\u503c\n    v_now  DATE := SYSDATE;\nBEGIN\n    NULL;\nEND;\n/\n"})}),"\n",(0,r.jsx)(e.h3,{id:"22-\u4f7f\u7528\u8868\u5b57\u6bb5\u7684\u7c7b\u578b\u63a8\u8350",children:"2.2 \u4f7f\u7528\u8868\u5b57\u6bb5\u7684\u7c7b\u578b\uff08\u63a8\u8350\uff09"}),"\n",(0,r.jsx)(e.p,{children:"\u907f\u514d\u5b57\u6bb5\u7c7b\u578b\u53d8\u5316\u4ea7\u751f\u811a\u672c\u62a5\u9519\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"v_emp_name employees.last_name%TYPE;\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u8868\u793a\u201c\u53d8\u91cf\u7684\u7c7b\u578b\u7531 employees \u8868\u4e2d last_name \u7684\u7c7b\u578b\u81ea\u52a8\u51b3\u5b9a\u201d\u3002"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"3-\u5e38\u7528\u6570\u636e\u7ed3\u6784-listarray\u96c6\u5408",children:(0,r.jsx)(e.strong,{children:"3. \u5e38\u7528\u6570\u636e\u7ed3\u6784 LIST/ARRAY\uff08\u96c6\u5408\uff09"})}),"\n",(0,r.jsx)(e.p,{children:"Oracle \u63d0\u4f9b\u4e09\u79cd\u96c6\u5408\uff1a"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u96c6\u5408\u7c7b\u578b"}),(0,r.jsx)(e.th,{children:"\u662f\u5426\u9700\u8981 SQL \u57df\u652f\u6301"}),(0,r.jsx)(e.th,{children:"\u662f\u5426\u53ef\u4f5c\u4e3a\u8868\u5217\u7c7b\u578b"}),(0,r.jsx)(e.th,{children:"\u662f\u5426\u53ef\u904d\u5386"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"VARRAY"})}),(0,r.jsx)(e.td,{children:"\u5426"}),(0,r.jsx)(e.td,{children:"\u662f"}),(0,r.jsx)(e.td,{children:"\u662f"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Nested Table"})}),(0,r.jsx)(e.td,{children:"\u5426"}),(0,r.jsx)(e.td,{children:"\u662f"}),(0,r.jsx)(e.td,{children:"\u662f"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Associative Array\uff08\u6700\u5e38\u7528\uff09"})}),(0,r.jsx)(e.td,{children:"\u5426"}),(0,r.jsx)(e.td,{children:"\u5426"}),(0,r.jsx)(e.td,{children:"\u662f"})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:["\u6700\u5e38\u7528\u7684\u662f ",(0,r.jsx)(e.strong,{children:"Associative Array\uff08Key-Value \u7c7b\u4f3c Map/List\uff09"}),"\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"DECLARE\n    TYPE t_ids IS TABLE OF NUMBER INDEX BY PLS_INTEGER;\n    v_ids t_ids;\n\nBEGIN\n    v_ids(1) := 10;\n    v_ids(2) := 20;\n    v_ids(3) := 30;\nEND;\n/\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u904d\u5386\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"FOR i IN v_ids.FIRST .. v_ids.LAST LOOP\n    IF v_ids.EXISTS(i) THEN\n        DBMS_OUTPUT.PUT_LINE('Value=' || v_ids(i));\n    END IF;\nEND LOOP;\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"4-\u8d4b\u503c\u65b9\u5f0f",children:(0,r.jsx)(e.strong,{children:"4. \u8d4b\u503c\u65b9\u5f0f"})}),"\n",(0,r.jsx)(e.h3,{id:"41-\u76f4\u63a5\u8d4b\u503c",children:"4.1 \u76f4\u63a5\u8d4b\u503c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"v_name := 'Tom';\n"})}),"\n",(0,r.jsx)(e.h3,{id:"42-sql-\u67e5\u8be2\u8d4b\u503cselect-into",children:"4.2 SQL \u67e5\u8be2\u8d4b\u503c\uff08SELECT INTO\uff09"}),"\n",(0,r.jsx)(e.p,{children:"PL/SQL \u5fc5\u987b\u4f7f\u7528 INTO\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"SELECT last_name INTO v_name\nFROM employees\nWHERE employee_id = 100;\n"})}),"\n",(0,r.jsx)(e.p,{children:"\uff08\u6ce8\u610f\uff1a\u5982\u8fd4\u56de 0 \u6216\u591a\u884c\u4f1a\u62a5\u9519\uff0c\u5f02\u5e38\u6355\u83b7\u8be6\u89c1\u540e\u9762\uff09"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"5-\u6761\u4ef6\u5224\u65adif--case",children:(0,r.jsx)(e.strong,{children:"5. \u6761\u4ef6\u5224\u65ad\uff08IF / CASE\uff09"})}),"\n",(0,r.jsx)(e.h3,{id:"51-if-\u8bed\u53e5",children:"5.1 IF \u8bed\u53e5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"IF v_age > 18 THEN\n    v_status := 'adult';\nELSIF v_age = 18 THEN\n    v_status := 'just adult';\nELSE\n    v_status := 'child';\nEND IF;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"52-case",children:"5.2 CASE"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"v_type := CASE \n             WHEN v_age >= 60 THEN 'senior'\n             WHEN v_age >= 18 THEN 'adult'\n             ELSE 'child'\n          END;\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"6-\u5faa\u73afforwhileloop",children:(0,r.jsx)(e.strong,{children:"6. \u5faa\u73af\uff08FOR/WHILE/LOOP\uff09"})}),"\n",(0,r.jsx)(e.h3,{id:"61-for-\u5faa\u73af",children:"6.1 FOR \u5faa\u73af"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"FOR i IN 1..10 LOOP\n    DBMS_OUTPUT.PUT_LINE(i);\nEND LOOP;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"62-while-\u5faa\u73af",children:"6.2 WHILE \u5faa\u73af"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"WHILE v_count < 10 LOOP\n    v_count := v_count + 1;\nEND LOOP;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"63-loop--exit",children:"6.3 LOOP + EXIT"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"LOOP\n    EXIT WHEN v_flag = 1;\nEND LOOP;\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"7-\u5f02\u5e38\u6355\u83b7exception",children:(0,r.jsx)(e.strong,{children:"7. \u5f02\u5e38\u6355\u83b7\uff08EXCEPTION\uff09"})}),"\n",(0,r.jsx)(e.p,{children:"Oracle PL/SQL \u7684\u5f02\u5e38\u6bd4\u8f83\u5f3a\u5927\uff0c\u5e38\u7528\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"EXCEPTION\n    WHEN NO_DATA_FOUND THEN\n        DBMS_OUTPUT.PUT_LINE('\u67e5\u8be2\u4e0d\u5230\u6570\u636e');\n    WHEN TOO_MANY_ROWS THEN\n        DBMS_OUTPUT.PUT_LINE('\u8fd4\u56de\u591a\u884c');\n    WHEN OTHERS THEN\n        DBMS_OUTPUT.PUT_LINE('\u672a\u77e5\u9519\u8bef: ' || SQLERRM);\nEND;\n/\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"SQLERRM"}),"\uff1a\u8fd4\u56de\u9519\u8bef\u6d88\u606f"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"SQLCODE"}),"\uff1a\u8fd4\u56de\u9519\u8bef\u4ee3\u7801"]}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"8-\u6253\u5370\u65e5\u5fd7dbms_output",children:(0,r.jsx)(e.strong,{children:"8. \u6253\u5370\u65e5\u5fd7\uff08DBMS_OUTPUT\uff09"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"DBMS_OUTPUT.PUT_LINE('Hello');\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u67d0\u4e9b IDE\uff08\u5982 SQLPlus \u9700\u8981\u5f00\u542f\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"SET SERVEROUTPUT ON;\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728 PL/SQL \u5757\u4e2d\u751f\u4ea7\u73af\u5883\u901a\u5e38\u4e0d\u4f7f\u7528 DBMS_OUTPUT\uff0c\u800c\u662f\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u63d2\u5165\u65e5\u5fd7\u8868"}),"\n",(0,r.jsx)(e.li,{children:"\u4f7f\u7528 PRAGMA AUTONOMOUS_TRANSACTION \u72ec\u7acb\u63d0\u4ea4\uff08\u7a0d\u540e\u8bb2\uff09"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"9-\u4e8b\u52a1\u63a7\u5236commitrollback",children:(0,r.jsx)(e.strong,{children:"9. \u4e8b\u52a1\u63a7\u5236\uff08COMMIT/ROLLBACK\uff09"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728 PL/SQL \u4e2d\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u9ed8\u8ba4\u9700\u8981 ",(0,r.jsx)(e.strong,{children:"\u4f60\u663e\u5f0f COMMIT"})]}),"\n",(0,r.jsx)(e.li,{children:"\u5f02\u5e38\u60c5\u51b5\u4e0b\u9700\u8981 rollback"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"\u4e8c\u4e00\u5957\u53ef\u76f4\u63a5\u7528\u4e8e\u751f\u4ea7\u7684\u9ad8\u5065\u58ee\u6027-oracle-\u811a\u672c\u6a21\u677f",children:(0,r.jsx)(e.strong,{children:"\u4e8c\u3001\u4e00\u5957\u53ef\u76f4\u63a5\u7528\u4e8e\u751f\u4ea7\u7684\u201c\u9ad8\u5065\u58ee\u6027 Oracle \u811a\u672c\u6a21\u677f\u201d"})}),"\n",(0,r.jsxs)(e.p,{children:["\u4e0b\u9762\u662f\u4e00\u4e2a",(0,r.jsx)(e.strong,{children:"\u94f6\u884c/\u91d1\u878d\u884c\u4e1a\u5e38\u7528\u7684\u6a21\u677f"}),"\uff0c\u9002\u7528\u4e8e\uff1a"]}),"\n",(0,r.jsx)(e.p,{children:"\u2714 \u8868\u4e0b\u7ebf\n\u2714 \u6570\u636e\u4fee\u590d\u811a\u672c\n\u2714 \u6570\u636e\u8fc1\u79fb\u811a\u672c\n\u2714 \u6279\u5904\u7406\u811a\u672c\n\u2714 \u4efb\u4f55\u9700\u8981\u53ef\u6062\u590d\u6027\u7684 SQL"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"\u751f\u4ea7\u7ea7-plsql-\u811a\u672c\u6a21\u677f\u542b\u65e5\u5fd7\u5f02\u5e38\u4e8b\u52a1\u6062\u590d\u65b9\u6848",children:(0,r.jsx)(e.strong,{children:"\ud83d\udccc\u751f\u4ea7\u7ea7 PL/SQL \u811a\u672c\u6a21\u677f\uff08\u542b\u65e5\u5fd7\u3001\u5f02\u5e38\u3001\u4e8b\u52a1\u3001\u6062\u590d\u65b9\u6848\uff09"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"SET SERVEROUTPUT ON;\nDECLARE\n    -- \u65e5\u5fd7\u53d8\u91cf\n    v_step   VARCHAR2(100);\n    v_msg    VARCHAR2(4000);\n\n    -- \u5b9e\u9645\u4e1a\u52a1\u53d8\u91cf\n    v_count  NUMBER := 0;\n\n    -- \u81ea\u6cbb\u4e8b\u52a1\u7528\u4e8e\u5199\u65e5\u5fd7\n    PRAGMA AUTONOMOUS_TRANSACTION;\n\n    -- \u65e5\u5fd7\u51fd\u6570\n    PROCEDURE write_log(p_step VARCHAR2, p_msg VARCHAR2) IS\n    BEGIN\n        INSERT INTO system_script_log(run_time, step, message)\n        VALUES (SYSDATE, p_step, p_msg);\n        COMMIT;    -- \u72ec\u7acb\u4e8b\u52a1\uff0c\u8bb0\u5f55\u65e5\u5fd7\u4e0d\u5f71\u54cd\u4e3b\u6d41\u7a0b\n    END;\n\nBEGIN\n    v_step := '1. \u5f00\u59cb\u6267\u884c\u811a\u672c';\n    write_log(v_step, '\u5f00\u59cb\u65f6\u95f4=' || TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS'));\n\n    ---------------------------------------------------------------------\n    -- \u7b2c\u4e00\u6b65\uff1a\u6821\u9a8c\u6570\u636e\n    ---------------------------------------------------------------------\n    v_step := '2. \u6570\u636e\u6821\u9a8c';\n    SELECT COUNT(*) INTO v_count FROM employees WHERE status IS NULL;\n\n    write_log(v_step, '\u7a7a\u72b6\u6001\u8bb0\u5f55\u6570=' || v_count);\n\n    ---------------------------------------------------------------------\n    -- \u7b2c\u4e8c\u6b65\uff1a\u5b9e\u9645\u4fee\u6539\u6570\u636e\n    ---------------------------------------------------------------------\n    v_step := '3. \u66f4\u65b0\u72b6\u6001';\n\n    UPDATE employees\n       SET status = 'ACTIVE'\n     WHERE status IS NULL;\n\n    write_log(v_step, '\u66f4\u65b0\u884c\u6570=' || SQL%ROWCOUNT);\n\n    ---------------------------------------------------------------------\n    -- \u7b2c\u4e09\u6b65\uff1a\u63d0\u4ea4\u4e8b\u52a1\n    ---------------------------------------------------------------------\n    v_step := '4. \u5b8c\u6210\u63d0\u4ea4';\n    COMMIT;\n\n    write_log(v_step, '\u811a\u672c\u6267\u884c\u5b8c\u6210');\n\nEXCEPTION\n    WHEN NO_DATA_FOUND THEN\n        write_log('\u5f02\u5e38', 'NO DATA FOUND');\n        ROLLBACK;\n        DBMS_OUTPUT.PUT_LINE('\u5f02\u5e38\uff1a\u672a\u627e\u5230\u6570\u636e');\n\n    WHEN OTHERS THEN\n        write_log('\u5f02\u5e38', SQLERRM);\n        ROLLBACK;\n        DBMS_OUTPUT.PUT_LINE('\u672a\u77e5\u9519\u8bef: ' || SQLERRM);\n\nEND;\n/\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"\u8fd9\u5957\u6a21\u677f\u7684\u7279\u70b9",children:(0,r.jsx)(e.strong,{children:"\u8fd9\u5957\u6a21\u677f\u7684\u7279\u70b9"})}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u7279\u6027"}),(0,r.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u53ef\u6062\u590d\u6027\u5f3a"})}),(0,r.jsx)(e.td,{children:"\u6240\u6709\u5173\u952e\u64cd\u4f5c\u524d\u90fd\u5199\u65e5\u5fd7"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u5f02\u5e38\u5b89\u5168"})}),(0,r.jsx)(e.td,{children:"\u4efb\u610f\u62a5\u9519\u7acb\u523b rollback"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u72ec\u7acb\u65e5\u5fd7\u4e8b\u52a1"})}),(0,r.jsx)(e.td,{children:"\u65e5\u5fd7\u4e0d\u4f1a\u56e0\u4e3a rollback \u4e22\u5931"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u4fe1\u606f\u900f\u660e"})}),(0,r.jsx)(e.td,{children:"\u660e\u786e\u6bcf\u4e00\u6b65\u6267\u884c\u60c5\u51b5"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u53ef\u5ba1\u8ba1"})}),(0,r.jsx)(e.td,{children:"\u65e5\u5fd7\u8868\u53ef\u6c38\u4e45\u4fdd\u5b58 audit \u4fe1\u606f"})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h1,{id:"\u4e09\u5982\u4f55\u5199\u4e00\u4e2a\u5065\u58ee\u6027\u9ad8\u7684-oracle-\u811a\u672c\u603b\u7ed3",children:(0,r.jsx)(e.strong,{children:"\u4e09\u3001\u5982\u4f55\u5199\u4e00\u4e2a\u5065\u58ee\u6027\u9ad8\u7684 Oracle \u811a\u672c\uff08\u603b\u7ed3\uff09"})}),"\n",(0,r.jsx)(e.h3,{id:"-1-\u5fc5\u987b\u8bb0\u5f55\u65e5\u5fd7\u4f7f\u7528\u81ea\u6cbb\u4e8b\u52a1",children:"\u2714 1. \u5fc5\u987b\u8bb0\u5f55\u65e5\u5fd7\uff08\u4f7f\u7528\u81ea\u6cbb\u4e8b\u52a1\uff09"}),"\n",(0,r.jsx)(e.h3,{id:"-2-\u5fc5\u987b\u6709\u5f02\u5e38\u6355\u83b7",children:"\u2714 2. \u5fc5\u987b\u6709\u5f02\u5e38\u6355\u83b7"}),"\n",(0,r.jsx)(e.h3,{id:"-3-\u5173\u952e\u6b65\u9aa4\u524d\u5fc5\u987b\u5199\u65e5\u5fd7\u65b9\u4fbf\u6062\u590d",children:"\u2714 3. \u5173\u952e\u6b65\u9aa4\u524d\u5fc5\u987b\u5199\u65e5\u5fd7\uff08\u65b9\u4fbf\u6062\u590d\uff09"}),"\n",(0,r.jsx)(e.h3,{id:"-4-\u6c38\u8fdc\u4e0d\u8981\u4f7f\u7528\u9690\u5f0f\u63d0\u4ea4\u5982-ddl",children:"\u2714 4. \u6c38\u8fdc\u4e0d\u8981\u4f7f\u7528\u9690\u5f0f\u63d0\u4ea4\uff08\u5982 DDL\uff09"}),"\n",(0,r.jsx)(e.h3,{id:"-5-\u68c0\u67e5\u5f71\u54cd\u884c\u6570\u907f\u514d\u8bef\u4f24sqlrowcount",children:"\u2714 5. \u68c0\u67e5\u5f71\u54cd\u884c\u6570\uff0c\u907f\u514d\u8bef\u4f24\uff08SQL%ROWCOUNT\uff09"}),"\n",(0,r.jsx)(e.h3,{id:"-6-\u4f7f\u7528-typerowtype-\u6765\u517c\u5bb9\u5b57\u6bb5\u53d8\u66f4",children:"\u2714 6. \u4f7f\u7528 %TYPE,%ROWTYPE \u6765\u517c\u5bb9\u5b57\u6bb5\u53d8\u66f4"}),"\n",(0,r.jsx)(e.h3,{id:"-7-\u8981\u6709\u5e72\u8dd1\u6a21\u5f0fdry-run\u53ea\u7edf\u8ba1\u4e0d\u66f4\u65b0",children:"\u2714 7. \u8981\u6709\u201c\u5e72\u8dd1\u201d\u6a21\u5f0f\uff08DRY RUN\uff09\uff0c\u53ea\u7edf\u8ba1\u4e0d\u66f4\u65b0"}),"\n",(0,r.jsx)(e.h3,{id:"-8-\u907f\u514d\u4e00\u6b21\u66f4\u65b0\u767e\u4e07\u884c\u4f7f\u7528\u5206\u6279\u5904\u7406limit-1000",children:"\u2714 8. \u907f\u514d\u4e00\u6b21\u66f4\u65b0\u767e\u4e07\u884c\uff0c\u4f7f\u7528\u5206\u6279\u5904\u7406\uff08LIMIT 1000\uff09"}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u679c\u4f60\u9700\u8981\uff0c\u6211\u53ef\u4ee5\u7ed9\u4f60\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"\u2705 \u751f\u4ea7\u7ea7\u5206\u6279\u5904\u7406\u811a\u672c\u6a21\u677f\uff08\u4f8b\u5982\u6bcf\u6b21\u5904\u7406 1000 \u6761\uff09\n\u2705 \u8868\u4e0b\u7ebf\u4e13\u4e1a\u811a\u672c\u6a21\u677f\uff08\u975e\u5e38\u9002\u5408\u4f60\u73b0\u5728\u7684\u94f6\u884c\u9879\u76ee\uff09\n\u2705 \u89e6\u53d1\u5668/\u89c6\u56fe\u4f9d\u8d56\u67e5\u8be2\u811a\u672c\n\u2705 Oracle \u5e38\u7528\u5de5\u5177\u811a\u672c\u5408\u96c6"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.p,{children:["\u5982\u679c\u4f60\u613f\u610f\uff0c\u6211\u53ef\u4ee5\u6839\u636e\u4f60\u5b9e\u9645\u8981",(0,r.jsx)(e.strong,{children:"\u4e0b\u7ebf\u7684\u5177\u4f53\u8868"}),"\uff0c\u7ed9\u4f60\u5199\u4e00\u4efd\u5b8c\u6574\u53ef\u6267\u884c\u3001\u5e26\u65e5\u5fd7\u3001\u53ef\u56de\u6eda\u7684\u4e13\u4e1a\u811a\u672c\u3002"]})]})}function x(n={}){const{wrapper:e}={...(0,d.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(a,{...n})}):a(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>i,x:()=>c});var l=s(6540);const r={},d=l.createContext(r);function i(n){const e=l.useContext(d);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:i(n.components),l.createElement(d.Provider,{value:e},n.children)}}}]);